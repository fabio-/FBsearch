<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

	<div style="background-color:#3b5998; width:100%;height:100px;">
    	<div id="header"><img id="logo" src="FacebookSearch.png"></div>
    </div>
    
    <div id="mainArea">
    	<h1>To Search for events in your city enter your location in the searach bar!</h1>
	
   		<div id="searchBar">
    		<input type="text" name="q" id="q"/>
           	<input type="submit" class="go"â€‹ value="Press"/>
        </div>
   	 </div>
    
    <div id="wrapper">
   		<div id="content"> </div>
    </div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

<script type="text/javascript">

$('.go').click(function() {
	
	//removes previous searches!
	$('#content').empty();

    $('.go').val("Loading...");
	
	 
	 //request valid access token
	 var requestURL = 'https://graph.facebook.com/oauth/access_token?%20client_id=136237449885255&client_secret=9f9191c07c175024dbc495c7914625c0&%20grant_type=client_credentials';
	
	var accessToken = $.ajax({
  	url: requestURL,
  	global: false,
  	type: "POST",
  	data: "name=value",
  	dataType: "html",
  	async:false,
  	success: function(msg){ }
	} ).responseText;


	//query the Facebook graph search with input parameters and valid access token
    var url = 'https://graph.facebook.com/search?q='+ $('#q').val()+'&type=event&'+accessToken;
	
	
    $.getJSON(url, function(data) {
            obj = data.data;
            Object.keys(obj).forEach(function(key){
			
				//Jquery used to append all the events retrieved
				//TODO: REMOVE EVENTS WITH THE SAME NAME ID
				//		"NEXT" PAGES TO PUT EVENTS THAT DON'T FIT IN FIRST PAGE!
				
			//	'<img align="right" src="https://graph.facebook.com/'+obj[key].id+'/picture?type=large" width="107" height="98" >'+
				//						'<b>'+obj[key].name+'</b>'+'<br>'+
										//'<div class="innerborder" align:right'+
										
										//'</div>'+
					//					'<br><img align=top src="location.png">'+"&#09"+obj[key].location+
						//				'<br>'+
							//			obj[key].timezone+
								//		'<br><a href=https://www.facebook.com/events/'+obj[key].id+'>event</a>';
				
					var out = '<div class="multiborder">'+
								'<div id="proPic"><img align=middle src="https://graph.facebook.com/'+obj[key].id+'/picture?type=large" width="107" height="98"> </div>'+
								'<div id="event" >'+'<b>'+obj[key].name+'</b>'+'</div>'+
								'<div id="sideTxt"><img align=middle src="location.png">&nbsp &nbsp &nbsp'+obj[key].timezone+'</div>';
							
										
										
                $('#content').append(out);
										
										$('#content').append('<br><br>');
										
			});
										 
										 
		
	$('#content').append('<br><br>');
	$('.go').val("Search");
    });

});


</script>
</body>
</html>